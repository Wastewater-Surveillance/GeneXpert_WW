# GeneXpert Exporting and Cleaning Data

This R script cleans the unreadable GeneXpert export csv file and transforms testing data into a tabular format.

As opposed to pdf test reports generated by the GeneXpert Dx software, there is no upper limit for the number of tests that can be exported by via csv export. Therefore, csv exports can be useful for handling mass testing data or archiving old data into a readable and transferable format. These csv exports also contain additional data such as probe check values and temperature readings if applicable to the assay.

### Table of Contents

- [How to Export Data as a csv From Your GeneXpert](#how-to-export-data-as-a-csv-from-your-geneXpert)
- [How to clean GeneXpert CSV Export](#how-to-clean-geneXpert-csv-export)

## How to Export Data as a csv From Your GeneXpert

1.  Log into your GeneXpert Dx System software
2.  At top of the screen, click **View Results**
3.  At the bottom of the screen, click **Export Results**
4.  Once in the **Export Data** window select *Analysis Parameters, Test Result, and Optical Data*
5.  Click **Select All** to get include all tests currently saved in the software
    -   Note: to include archived tests, they must be imported back into the software.
6.  Click **Export** and save the csv file

## How to clean GeneXpert CSV Export

The main cleaning function ([clean_gx_csv.R](./clean_gx_csv.R)) currently works for any GeneXpert assay and supports English and French csv files. The function returns a list of dataframes separated by assay with test data in long format (one test per row). There are also arguments for removing sample and patient ID, fixing date formats, and flagging positive multiplex SARS/Flu/RSV quality control tests.  

To load the cleaning function into your R environment:  
  
```R
source("clean_gx_csv.R") 
```

To clean GeneXpert CSV export data ([GX_export_demo.csv](./GX_export_demo.csv)), please run:

```R
clean_gx_csv("GX_export_demo.csv",
  date_format = "ymd",
  mask_IDS = FALSE,
  flag_qc = TRUE)
```
